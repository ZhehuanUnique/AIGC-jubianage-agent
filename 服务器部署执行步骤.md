# æœåŠ¡å™¨éƒ¨ç½²æ‰§è¡Œæ­¥éª¤

## ğŸ“‹ æœåŠ¡å™¨ä¿¡æ¯
- **IPåœ°å€**ï¼š119.45.121.152
- **ç”¨æˆ·å**ï¼šubuntu
- **å¯†ç **ï¼šrXTg#!G$6c45yxZ
- **åŸŸå**ï¼šjubianai.cn

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

åœ¨æœ¬åœ° PowerShell æˆ– CMD ä¸­æ‰§è¡Œï¼š

```bash
ssh ubuntu@119.45.121.152
```

è¾“å…¥å¯†ç ï¼š`rXTg#!G$6c45yxZ`

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæŒ‰é¡ºåºï¼‰

### æ­¥éª¤ 1ï¼šæ›´æ–°ç³»ç»Ÿ

```bash
sudo apt update && sudo apt upgrade -y
```

### æ­¥éª¤ 2ï¼šå®‰è£… Node.jsï¼ˆä½¿ç”¨ NVMï¼‰

```bash
# å®‰è£… NVM
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc

# å®‰è£… Node.js 20
nvm install 20
nvm use 20
nvm alias default 20

# éªŒè¯å®‰è£…
node -v
npm -v
```

### æ­¥éª¤ 3ï¼šå®‰è£… PM2

```bash
npm install -g pm2
```

### æ­¥éª¤ 4ï¼šå®‰è£… Nginx

```bash
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx
```

### æ­¥éª¤ 5ï¼šå®‰è£… Git

```bash
sudo apt install git -y
```

### æ­¥éª¤ 6ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•

```bash
sudo mkdir -p /var/www/aigc-agent
sudo chown ubuntu:ubuntu /var/www/aigc-agent
```

### æ­¥éª¤ 7ï¼šå…‹éš†ä»£ç 

```bash
cd /var/www/aigc-agent
git clone https://github.com/ZhehuanUnique/AIGC-jubianage-agent.git .
```

### æ­¥éª¤ 8ï¼šå®‰è£…ä¾èµ–

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å®‰è£…åç«¯ä¾èµ–
cd server
npm install
cd ..
```

### æ­¥éª¤ 9ï¼šæ„å»ºå‰ç«¯

```bash
npm run build
```

---

## âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
cd /var/www/aigc-agent/server
cp env.example .env
nano .env
```

**åœ¨ç¼–è¾‘å™¨ä¸­é…ç½®ä»¥ä¸‹å¿…éœ€å˜é‡**ï¼ˆæŒ‰ `Ctrl + X` ä¿å­˜ï¼ŒæŒ‰ `Y` ç¡®è®¤ï¼ŒæŒ‰ `Enter` é€€å‡ºï¼‰ï¼š

```env
PORT=3002
DASHSCOPE_API_KEY=ä½ çš„é€šä¹‰åƒé—®APIå¯†é’¥
QWEN_MODEL=qwen-plus
DATABASE_URL=ä½ çš„Supabaseè¿æ¥å­—ç¬¦ä¸²
COS_SECRET_ID=ä½ çš„è…¾è®¯äº‘SecretId
COS_SECRET_KEY=ä½ çš„è…¾è®¯äº‘SecretKey
COS_REGION=ap-guangzhou
COS_BUCKET=ä½ çš„å­˜å‚¨æ¡¶åç§°
JWT_SECRET=ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ä½œä¸ºJWTå¯†é’¥
```

---

## ğŸš€ ç¬¬å››æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
cd /var/www/aigc-agent/server
pm2 start index.js --name aigc-agent
pm2 save
pm2 startup
# æŒ‰ç…§æç¤ºæ‰§è¡Œè¾“å‡ºçš„ sudo å‘½ä»¤
```

**éªŒè¯æœåŠ¡**ï¼š

```bash
pm2 status
pm2 logs aigc-agent
curl http://localhost:3002/health
```

---

## ğŸŒ ç¬¬äº”æ­¥ï¼šé…ç½® Nginx

```bash
sudo nano /etc/nginx/sites-available/aigc-agent
```

**å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ°ç¼–è¾‘å™¨**ï¼š

```nginx
server {
    listen 80;
    server_name jubianai.cn www.jubianai.cn;

    location / {
        root /var/www/aigc-agent/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }

    location /api {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        root /var/www/aigc-agent/dist;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

**ä¿å­˜å¹¶å¯ç”¨é…ç½®**ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/aigc-agent /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl reload nginx
```

---

## ğŸ”’ ç¬¬å…­æ­¥ï¼šé…ç½® SSL è¯ä¹¦

```bash
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d jubianai.cn -d www.jubianai.cn
```

æŒ‰ç…§æç¤ºè¾“å…¥é‚®ç®±å¹¶åŒæ„æ¡æ¬¾ã€‚

---

## ğŸ”¥ ç¬¬ä¸ƒæ­¥ï¼šé…ç½®é˜²ç«å¢™

```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
sudo ufw status
```

---

## âœ… ç¬¬å…«æ­¥ï¼šéªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
sudo systemctl status nginx

# æµ‹è¯• API
curl http://localhost:3002/health

# æµ‹è¯•ç½‘ç«™
curl http://localhost
```

**è®¿é—®ç½‘ç«™**ï¼š
- http://jubianai.cn
- https://jubianai.cnï¼ˆé…ç½® SSL åï¼‰

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. ç¡®ä¿åŸŸå `jubianai.cn` å·²è§£æåˆ° `119.45.121.152`
2. ç¡®ä¿è…¾è®¯äº‘å®‰å…¨ç»„å·²å¼€æ”¾ 22ã€80ã€443 ç«¯å£
3. ç¯å¢ƒå˜é‡ä¸­çš„ JWT_SECRET éœ€è¦æ˜¯ä¸€ä¸ªå¼ºéšæœºå­—ç¬¦ä¸²


## ğŸ“‹ æœåŠ¡å™¨ä¿¡æ¯
- **IPåœ°å€**ï¼š119.45.121.152
- **ç”¨æˆ·å**ï¼šubuntu
- **å¯†ç **ï¼šrXTg#!G$6c45yxZ
- **åŸŸå**ï¼šjubianai.cn

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

åœ¨æœ¬åœ° PowerShell æˆ– CMD ä¸­æ‰§è¡Œï¼š

```bash
ssh ubuntu@119.45.121.152
```

è¾“å…¥å¯†ç ï¼š`rXTg#!G$6c45yxZ`

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæŒ‰é¡ºåºï¼‰

### æ­¥éª¤ 1ï¼šæ›´æ–°ç³»ç»Ÿ

```bash
sudo apt update && sudo apt upgrade -y
```

### æ­¥éª¤ 2ï¼šå®‰è£… Node.jsï¼ˆä½¿ç”¨ NVMï¼‰

```bash
# å®‰è£… NVM
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc

# å®‰è£… Node.js 20
nvm install 20
nvm use 20
nvm alias default 20

# éªŒè¯å®‰è£…
node -v
npm -v
```

### æ­¥éª¤ 3ï¼šå®‰è£… PM2

```bash
npm install -g pm2
```

### æ­¥éª¤ 4ï¼šå®‰è£… Nginx

```bash
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx
```

### æ­¥éª¤ 5ï¼šå®‰è£… Git

```bash
sudo apt install git -y
```

### æ­¥éª¤ 6ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•

```bash
sudo mkdir -p /var/www/aigc-agent
sudo chown ubuntu:ubuntu /var/www/aigc-agent
```

### æ­¥éª¤ 7ï¼šå…‹éš†ä»£ç 

```bash
cd /var/www/aigc-agent
git clone https://github.com/ZhehuanUnique/AIGC-jubianage-agent.git .
```

### æ­¥éª¤ 8ï¼šå®‰è£…ä¾èµ–

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å®‰è£…åç«¯ä¾èµ–
cd server
npm install
cd ..
```

### æ­¥éª¤ 9ï¼šæ„å»ºå‰ç«¯

```bash
npm run build
```

---

## âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
cd /var/www/aigc-agent/server
cp env.example .env
nano .env
```

**åœ¨ç¼–è¾‘å™¨ä¸­é…ç½®ä»¥ä¸‹å¿…éœ€å˜é‡**ï¼ˆæŒ‰ `Ctrl + X` ä¿å­˜ï¼ŒæŒ‰ `Y` ç¡®è®¤ï¼ŒæŒ‰ `Enter` é€€å‡ºï¼‰ï¼š

```env
PORT=3002
DASHSCOPE_API_KEY=ä½ çš„é€šä¹‰åƒé—®APIå¯†é’¥
QWEN_MODEL=qwen-plus
DATABASE_URL=ä½ çš„Supabaseè¿æ¥å­—ç¬¦ä¸²
COS_SECRET_ID=ä½ çš„è…¾è®¯äº‘SecretId
COS_SECRET_KEY=ä½ çš„è…¾è®¯äº‘SecretKey
COS_REGION=ap-guangzhou
COS_BUCKET=ä½ çš„å­˜å‚¨æ¡¶åç§°
JWT_SECRET=ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ä½œä¸ºJWTå¯†é’¥
```

---

## ğŸš€ ç¬¬å››æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
cd /var/www/aigc-agent/server
pm2 start index.js --name aigc-agent
pm2 save
pm2 startup
# æŒ‰ç…§æç¤ºæ‰§è¡Œè¾“å‡ºçš„ sudo å‘½ä»¤
```

**éªŒè¯æœåŠ¡**ï¼š

```bash
pm2 status
pm2 logs aigc-agent
curl http://localhost:3002/health
```

---

## ğŸŒ ç¬¬äº”æ­¥ï¼šé…ç½® Nginx

```bash
sudo nano /etc/nginx/sites-available/aigc-agent
```

**å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ°ç¼–è¾‘å™¨**ï¼š

```nginx
server {
    listen 80;
    server_name jubianai.cn www.jubianai.cn;

    location / {
        root /var/www/aigc-agent/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }

    location /api {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        root /var/www/aigc-agent/dist;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

**ä¿å­˜å¹¶å¯ç”¨é…ç½®**ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/aigc-agent /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl reload nginx
```

---

## ğŸ”’ ç¬¬å…­æ­¥ï¼šé…ç½® SSL è¯ä¹¦

```bash
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d jubianai.cn -d www.jubianai.cn
```

æŒ‰ç…§æç¤ºè¾“å…¥é‚®ç®±å¹¶åŒæ„æ¡æ¬¾ã€‚

---

## ğŸ”¥ ç¬¬ä¸ƒæ­¥ï¼šé…ç½®é˜²ç«å¢™

```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
sudo ufw status
```

---

## âœ… ç¬¬å…«æ­¥ï¼šéªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
sudo systemctl status nginx

# æµ‹è¯• API
curl http://localhost:3002/health

# æµ‹è¯•ç½‘ç«™
curl http://localhost
```

**è®¿é—®ç½‘ç«™**ï¼š
- http://jubianai.cn
- https://jubianai.cnï¼ˆé…ç½® SSL åï¼‰

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. ç¡®ä¿åŸŸå `jubianai.cn` å·²è§£æåˆ° `119.45.121.152`
2. ç¡®ä¿è…¾è®¯äº‘å®‰å…¨ç»„å·²å¼€æ”¾ 22ã€80ã€443 ç«¯å£
3. ç¯å¢ƒå˜é‡ä¸­çš„ JWT_SECRET éœ€è¦æ˜¯ä¸€ä¸ªå¼ºéšæœºå­—ç¬¦ä¸²


## ğŸ“‹ æœåŠ¡å™¨ä¿¡æ¯
- **IPåœ°å€**ï¼š119.45.121.152
- **ç”¨æˆ·å**ï¼šubuntu
- **å¯†ç **ï¼šrXTg#!G$6c45yxZ
- **åŸŸå**ï¼šjubianai.cn

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

åœ¨æœ¬åœ° PowerShell æˆ– CMD ä¸­æ‰§è¡Œï¼š

```bash
ssh ubuntu@119.45.121.152
```

è¾“å…¥å¯†ç ï¼š`rXTg#!G$6c45yxZ`

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæŒ‰é¡ºåºï¼‰

### æ­¥éª¤ 1ï¼šæ›´æ–°ç³»ç»Ÿ

```bash
sudo apt update && sudo apt upgrade -y
```

### æ­¥éª¤ 2ï¼šå®‰è£… Node.jsï¼ˆä½¿ç”¨ NVMï¼‰

```bash
# å®‰è£… NVM
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc

# å®‰è£… Node.js 20
nvm install 20
nvm use 20
nvm alias default 20

# éªŒè¯å®‰è£…
node -v
npm -v
```

### æ­¥éª¤ 3ï¼šå®‰è£… PM2

```bash
npm install -g pm2
```

### æ­¥éª¤ 4ï¼šå®‰è£… Nginx

```bash
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx
```

### æ­¥éª¤ 5ï¼šå®‰è£… Git

```bash
sudo apt install git -y
```

### æ­¥éª¤ 6ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•

```bash
sudo mkdir -p /var/www/aigc-agent
sudo chown ubuntu:ubuntu /var/www/aigc-agent
```

### æ­¥éª¤ 7ï¼šå…‹éš†ä»£ç 

```bash
cd /var/www/aigc-agent
git clone https://github.com/ZhehuanUnique/AIGC-jubianage-agent.git .
```

### æ­¥éª¤ 8ï¼šå®‰è£…ä¾èµ–

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å®‰è£…åç«¯ä¾èµ–
cd server
npm install
cd ..
```

### æ­¥éª¤ 9ï¼šæ„å»ºå‰ç«¯

```bash
npm run build
```

---

## âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
cd /var/www/aigc-agent/server
cp env.example .env
nano .env
```

**åœ¨ç¼–è¾‘å™¨ä¸­é…ç½®ä»¥ä¸‹å¿…éœ€å˜é‡**ï¼ˆæŒ‰ `Ctrl + X` ä¿å­˜ï¼ŒæŒ‰ `Y` ç¡®è®¤ï¼ŒæŒ‰ `Enter` é€€å‡ºï¼‰ï¼š

```env
PORT=3002
DASHSCOPE_API_KEY=ä½ çš„é€šä¹‰åƒé—®APIå¯†é’¥
QWEN_MODEL=qwen-plus
DATABASE_URL=ä½ çš„Supabaseè¿æ¥å­—ç¬¦ä¸²
COS_SECRET_ID=ä½ çš„è…¾è®¯äº‘SecretId
COS_SECRET_KEY=ä½ çš„è…¾è®¯äº‘SecretKey
COS_REGION=ap-guangzhou
COS_BUCKET=ä½ çš„å­˜å‚¨æ¡¶åç§°
JWT_SECRET=ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ä½œä¸ºJWTå¯†é’¥
```

---

## ğŸš€ ç¬¬å››æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
cd /var/www/aigc-agent/server
pm2 start index.js --name aigc-agent
pm2 save
pm2 startup
# æŒ‰ç…§æç¤ºæ‰§è¡Œè¾“å‡ºçš„ sudo å‘½ä»¤
```

**éªŒè¯æœåŠ¡**ï¼š

```bash
pm2 status
pm2 logs aigc-agent
curl http://localhost:3002/health
```

---

## ğŸŒ ç¬¬äº”æ­¥ï¼šé…ç½® Nginx

```bash
sudo nano /etc/nginx/sites-available/aigc-agent
```

**å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ°ç¼–è¾‘å™¨**ï¼š

```nginx
server {
    listen 80;
    server_name jubianai.cn www.jubianai.cn;

    location / {
        root /var/www/aigc-agent/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }

    location /api {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        root /var/www/aigc-agent/dist;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

**ä¿å­˜å¹¶å¯ç”¨é…ç½®**ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/aigc-agent /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl reload nginx
```

---

## ğŸ”’ ç¬¬å…­æ­¥ï¼šé…ç½® SSL è¯ä¹¦

```bash
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d jubianai.cn -d www.jubianai.cn
```

æŒ‰ç…§æç¤ºè¾“å…¥é‚®ç®±å¹¶åŒæ„æ¡æ¬¾ã€‚

---

## ğŸ”¥ ç¬¬ä¸ƒæ­¥ï¼šé…ç½®é˜²ç«å¢™

```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
sudo ufw status
```

---

## âœ… ç¬¬å…«æ­¥ï¼šéªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
sudo systemctl status nginx

# æµ‹è¯• API
curl http://localhost:3002/health

# æµ‹è¯•ç½‘ç«™
curl http://localhost
```

**è®¿é—®ç½‘ç«™**ï¼š
- http://jubianai.cn
- https://jubianai.cnï¼ˆé…ç½® SSL åï¼‰

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. ç¡®ä¿åŸŸå `jubianai.cn` å·²è§£æåˆ° `119.45.121.152`
2. ç¡®ä¿è…¾è®¯äº‘å®‰å…¨ç»„å·²å¼€æ”¾ 22ã€80ã€443 ç«¯å£
3. ç¯å¢ƒå˜é‡ä¸­çš„ JWT_SECRET éœ€è¦æ˜¯ä¸€ä¸ªå¼ºéšæœºå­—ç¬¦ä¸²



