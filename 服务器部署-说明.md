# 服务器部署说明

## 方法一：使用脚本（推荐）

### 在本地执行：
```bash
ssh ubuntu@119.45.121.152 "bash -s" < 服务器部署.sh
```

### 或者先上传脚本，再在服务器上执行：
```bash
# 1. 上传脚本到服务器
scp 服务器部署.sh ubuntu@119.45.121.152:/tmp/

# 2. SSH 连接到服务器
ssh ubuntu@119.45.121.152

# 3. 在服务器上执行
chmod +x /tmp/服务器部署.sh
/tmp/服务器部署.sh
```

## 方法二：手动执行（逐步）

### 1. 连接到服务器
```bash
ssh ubuntu@119.45.121.152
```

### 2. 进入项目目录
```bash
cd /var/www/aigc-agent
```

### 3. 强制拉取最新代码
```bash
git fetch origin
git reset --hard origin/main
```

### 4. 清理并重新构建前端
```bash
rm -rf dist node_modules/.vite
npm run build
```

### 5. 设置权限并重启服务
```bash
sudo chown -R ubuntu:ubuntu dist/
cd server
pm2 restart aigc-agent
cd ..
sudo systemctl reload nginx
```

## 验证部署

### 检查服务状态
```bash
pm2 status aigc-agent
pm2 logs aigc-agent --lines 20
```

### 检查 Nginx 状态
```bash
sudo systemctl status nginx
```

### 检查最新代码版本
```bash
cd /var/www/aigc-agent
git log -1 --oneline
```

