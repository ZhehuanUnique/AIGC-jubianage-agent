# 在服务器端配置火山引擎API密钥 - 快速命令

## 方法1: 使用配置脚本（推荐）

```bash
# 进入项目目录
cd /home/ubuntu/AIGC-jubianage-agent
# 或
cd ~/AIGC-jubianage-agent
# 或（需要sudo）
sudo su -
cd /root/AIGC-jubianage-agent

# 拉取最新代码（包含配置脚本）
git pull origin main

# 执行配置脚本
chmod +x 服务器配置火山引擎API.sh
./服务器配置火山引擎API.sh
```

## 方法2: 手动执行命令

```bash
# 1. 进入server目录
cd /home/ubuntu/AIGC-jubianage-agent/server
# 或
cd ~/AIGC-jubianage-agent/server
# 或（需要sudo）
sudo su -
cd /root/AIGC-jubianage-agent/server

# 2. 备份现有.env文件（如果存在）
if [ -f ".env" ]; then
    cp .env .env.backup.$(date +%Y%m%d_%H%M%S)
fi

# 3. 检查是否已存在配置，如果存在先删除
sed -i '/^VOLCENGINE_AK=/d' .env 2>/dev/null
sed -i '/^VOLCENGINE_SK=/d' .env 2>/dev/null
sed -i '/^VOLCENGINE_API_HOST=/d' .env 2>/dev/null

# 4. 添加配置到.env文件
echo "" >> .env
echo "# 火山引擎即梦AI-视频生成3.0 Pro配置" >> .env
echo "VOLCENGINE_AK=AKLTYjM1ZTY4NWRiMWEyNDg4NDg1ZTBhODdlYWNmYzY5ZTI" >> .env
echo "VOLCENGINE_SK=WVRoall6QmtNMkUwTnpsaE5EbGpZbUV5T1RZeU16Y3pZVGN4TnpKa01UTQ==" >> .env
echo "VOLCENGINE_API_HOST=https://visual.volcengineapi.com" >> .env

# 5. 验证配置
grep "VOLCENGINE" .env

# 6. 重启后端服务
pm2 restart AIGC-jubianage-agent
```

## 方法3: 使用nano或vi编辑器

```bash
# 进入server目录
cd /home/ubuntu/AIGC-jubianage-agent/server

# 编辑.env文件
nano .env
# 或
vi .env

# 在文件末尾添加以下三行：
VOLCENGINE_AK=AKLTYjM1ZTY4NWRiMWEyNDg4NDg1ZTBhODdlYWNmYzY5ZTI
VOLCENGINE_SK=WVRoall6QmtNMkUwTnpsaE5EbGpZbUV5T1RZeU16Y3pZVGN4TnpKa01UTQ==
VOLCENGINE_API_HOST=https://visual.volcengineapi.com

# 保存并退出（nano: Ctrl+X, Y, Enter | vi: :wq）
```

## 验证配置

```bash
# 检查配置是否正确
cd /home/ubuntu/AIGC-jubianage-agent/server
node check-volcengine-config.js
# 或
npm run check-volcengine
```

## 重启服务

```bash
# 重启后端服务使配置生效
pm2 restart AIGC-jubianage-agent

# 查看日志确认
pm2 logs AIGC-jubianage-agent --lines 50
```

