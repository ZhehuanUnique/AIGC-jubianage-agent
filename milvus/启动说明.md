# Milvus Docker Compose å¯åŠ¨è¯´æ˜

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹æ³•1ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆWindowsï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š
```bash
å¯åŠ¨Milvus-DockerCompose.bat
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨å¯åŠ¨

1. **è¿›å…¥ milvus ç›®å½•**ï¼š
   ```bash
   cd milvus
   ```

2. **å¯åŠ¨æœåŠ¡**ï¼š
   ```bash
   docker-compose up -d
   ```

3. **æŸ¥çœ‹æœåŠ¡çŠ¶æ€**ï¼š
   ```bash
   docker-compose ps
   ```

4. **æŸ¥çœ‹æ—¥å¿—**ï¼š
   ```bash
   docker-compose logs -f
   ```

## ğŸ“‹ æœåŠ¡è¯´æ˜

Docker Compose ä¼šå¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼š

1. **etcd** - å…ƒæ•°æ®å­˜å‚¨
   - å®¹å™¨åï¼š`milvus-etcd`
   - ç«¯å£ï¼š2379ï¼ˆå†…éƒ¨ï¼‰

2. **minio** - å¯¹è±¡å­˜å‚¨
   - å®¹å™¨åï¼š`milvus-minio`
   - ç«¯å£ï¼š9000ï¼ˆAPIï¼‰ã€9001ï¼ˆæ§åˆ¶å°ï¼‰
   - è®¿é—®ï¼šhttp://localhost:9001
   - ç”¨æˆ·åï¼š`minioadmin`
   - å¯†ç ï¼š`minioadmin`

3. **milvus-standalone** - Milvus ä¸»æœåŠ¡
   - å®¹å™¨åï¼š`milvus-standalone`
   - ç«¯å£ï¼š19530ï¼ˆgRPCï¼‰ã€9091ï¼ˆHTTPï¼‰
   - å¥åº·æ£€æŸ¥ï¼šhttp://localhost:9091/healthz

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### å¯åŠ¨æœåŠ¡
```bash
cd milvus
docker-compose up -d
```

### åœæ­¢æœåŠ¡
```bash
cd milvus
docker-compose down
```

### é‡å¯æœåŠ¡
```bash
cd milvus
docker-compose restart
```

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
cd milvus
docker-compose ps
```

### æŸ¥çœ‹æ—¥å¿—
```bash
cd milvus
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f standalone
```

### åœæ­¢å¹¶åˆ é™¤æ•°æ®
```bash
cd milvus
docker-compose down -v
```

## ğŸ” éªŒè¯æœåŠ¡

### 1. æ£€æŸ¥å®¹å™¨çŠ¶æ€
```bash
docker ps | findstr milvus
```

åº”è¯¥çœ‹åˆ°ä¸‰ä¸ªå®¹å™¨ï¼š
- `milvus-etcd`
- `milvus-minio`
- `milvus-standalone`

### 2. æ£€æŸ¥ Milvus å¥åº·çŠ¶æ€
```bash
curl http://localhost:9091/healthz
```

åº”è¯¥è¿”å› `OK`ã€‚

### 3. æ£€æŸ¥ç«¯å£
```bash
netstat -an | findstr "19530\|9091\|9000\|9001"
```

åº”è¯¥çœ‹åˆ°è¿™äº›ç«¯å£æ­£åœ¨ç›‘å¬ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¯åŠ¨æ—¶é—´**ï¼šMilvus å®Œå…¨å¯åŠ¨éœ€è¦ 30-60 ç§’ï¼Œè¯·è€å¿ƒç­‰å¾…
2. **æ•°æ®æŒä¹…åŒ–**ï¼šæ•°æ®å­˜å‚¨åœ¨ `milvus/volumes/` ç›®å½•ä¸‹
3. **ç«¯å£å ç”¨**ï¼šç¡®ä¿ä»¥ä¸‹ç«¯å£æœªè¢«å ç”¨ï¼š
   - 19530 (Milvus gRPC)
   - 9091 (Milvus HTTP)
   - 9000 (MinIO API)
   - 9001 (MinIO æ§åˆ¶å°)

## ğŸ”„ é…ç½®åç«¯æœåŠ¡

å¯åŠ¨ Milvus åï¼Œåœ¨ `server/.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```env
VECTOR_DB_TYPE=milvus
MILVUS_HOST=localhost
MILVUS_PORT=19530
```

ç„¶åé‡å¯åç«¯æœåŠ¡ã€‚

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ç«¯å£å ç”¨ï¼š
   ```bash
   netstat -ano | findstr 19530
   ```
2. åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼Œæˆ–ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„

### é—®é¢˜2ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æŸ¥çœ‹æ—¥å¿—ï¼š
   ```bash
   docker-compose logs
   ```
2. æ£€æŸ¥ Docker èµ„æºï¼š
   ```bash
   docker system df
   ```
3. æ¸…ç†æœªä½¿ç”¨çš„èµ„æºï¼š
   ```bash
   docker system prune
   ```

### é—®é¢˜3ï¼šæ•°æ®ä¸¢å¤±

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ•°æ®å­˜å‚¨åœ¨ `milvus/volumes/` ç›®å½•
- ä¸è¦åˆ é™¤æ­¤ç›®å½•
- ä½¿ç”¨ `docker-compose down`ï¼ˆä¸åŠ  `-v`ï¼‰åœæ­¢æœåŠ¡ï¼Œä¿ç•™æ•°æ®

---

**åˆ›å»ºæ—¶é—´**ï¼š2026-01-03

