# ğŸš€ å¼€å§‹éƒ¨ç½² IQuest-Coder-V1-14B

## ğŸ“¦ ä½ å°†å¾—åˆ°ä»€ä¹ˆ

- âœ… **é«˜æ€§èƒ½ä»£ç ç”Ÿæˆ API** - 40-60 tokens/ç§’
- âœ… **OpenAI å…¼å®¹æ¥å£** - æ— ç¼é›†æˆç°æœ‰é¡¹ç›®
- âœ… **ç¨³å®šå¯é ** - æ˜¾å­˜å……è¶³ï¼Œä¸ä¼š OOM
- âœ… **æ”¯æŒé•¿ä¸Šä¸‹æ–‡** - 32K tokens
- âœ… **é«˜å¹¶å‘èƒ½åŠ›** - å¯åŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚

## ğŸ¯ ä¸‰æ­¥å®Œæˆéƒ¨ç½²

### æ­¥éª¤ 1: ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

```bash
# åœ¨ä½ çš„æœ¬åœ°ç”µè„‘æ‰§è¡Œ
scp -r iquest-coder-deploy ubuntu@ä½ çš„æœåŠ¡å™¨IP:~/
```

### æ­¥éª¤ 2: è¿æ¥æœåŠ¡å™¨å¹¶éƒ¨ç½²

```bash
# SSH è¿æ¥
ssh ubuntu@ä½ çš„æœåŠ¡å™¨IP

# è¿›å…¥ç›®å½•
cd iquest-coder-deploy

# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy_14b.sh

# ä¸€é”®éƒ¨ç½²ï¼ˆè‡ªåŠ¨å®Œæˆæ‰€æœ‰é…ç½®ï¼‰
./deploy_14b.sh
```

**è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ**ï¼š
- âœ… æ£€æŸ¥ Docker å’Œ GPU ç¯å¢ƒ
- âœ… æ„å»º Docker é•œåƒ
- âœ… ä¸‹è½½æ¨¡å‹ï¼ˆçº¦ 8GBï¼Œ5-10 åˆ†é’Ÿï¼‰
- âœ… å¯åŠ¨æœåŠ¡
- âœ… ç­‰å¾…æœåŠ¡å°±ç»ª
- âœ… æ˜¾ç¤ºéƒ¨ç½²ç»“æœ

### æ­¥éª¤ 3: æµ‹è¯• API

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# è¿è¡Œå®Œæ•´æµ‹è¯•
python3 test_api_14b.py
```

## ğŸ“Š é¢„æœŸç»“æœ

### æ˜¾å­˜ä½¿ç”¨
```
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 535.xx       Driver Version: 535.xx       CUDA Version: 12.1    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  NVIDIA RTX 5090     Off  | 00000000:01:00.0 Off |                  N/A |
| 30%   45C    P2    80W / 450W |  10240MiB / 32768MiB |     85%      Default |
+-------------------------------+----------------------+----------------------+
```

**æ˜¾å­˜å ç”¨**: çº¦ 10GBï¼ˆéå¸¸å……è£•ï¼‰  
**å‰©ä½™æ˜¾å­˜**: çº¦ 22GBï¼ˆå¯ç”¨äºç¼“å­˜å’Œå¹¶å‘ï¼‰

### æ€§èƒ½æŒ‡æ ‡
```
ğŸ“Š æ€§èƒ½ç»Ÿè®¡

æµ‹è¯•ç”¨ä¾‹æ•°: 6
å¹³å‡è€—æ—¶: 3.5 ç§’
å¹³å‡ Token æ•°: 180
å¹³å‡é€Ÿåº¦: 51.4 tokens/ç§’

æ€§èƒ½è¯„ä¼°:
âœ… ä¼˜ç§€ - æ¨ç†é€Ÿåº¦éå¸¸å¿«
```

### API å“åº”ç¤ºä¾‹
```json
{
  "id": "chatcmpl-xxx",
  "object": "chat.completion",
  "created": 1704067200,
  "model": "IQuestLab/IQuest-Coder-V1-14B-Instruct",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "def fibonacci(n):\n    \"\"\"è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬ n é¡¹\"\"\"\n    if n <= 1:\n        return n\n    \n    # ä½¿ç”¨åŠ¨æ€è§„åˆ’ä¼˜åŒ–\n    dp = [0] * (n + 1)\n    dp[1] = 1\n    \n    for i in range(2, n + 1):\n        dp[i] = dp[i-1] + dp[i-2]\n    \n    return dp[n]"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 25,
    "completion_tokens": 120,
    "total_tokens": 145
  }
}
```

## ğŸŒ é…ç½®å¤–ç½‘è®¿é—®ï¼ˆå¯é€‰ï¼‰

### æ–¹æ³• 1: ç›´æ¥å¼€æ”¾ç«¯å£

```bash
# 1. å¼€æ”¾é˜²ç«å¢™
sudo ufw allow 8000/tcp
sudo ufw reload

# 2. é…ç½®è…¾è®¯äº‘å®‰å…¨ç»„
# ç™»å½•è…¾è®¯äº‘æ§åˆ¶å° -> äº‘æœåŠ¡å™¨ -> å®‰å…¨ç»„
# æ·»åŠ å…¥ç«™è§„åˆ™: TCP 8000, æ¥æº 0.0.0.0/0

# 3. æµ‹è¯•è®¿é—®
curl http://ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP:8000/health
```

### æ–¹æ³• 2: ä½¿ç”¨ Nginx åå‘ä»£ç†ï¼ˆæ¨èï¼‰

```bash
# 1. å®‰è£… Nginx
sudo apt-get update
sudo apt-get install nginx

# 2. åˆ›å»ºé…ç½®æ–‡ä»¶
sudo tee /etc/nginx/sites-available/iquest-coder > /dev/null << 'EOF'
server {
    listen 80;
    server_name _;

    location / {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }
}
EOF

# 3. å¯ç”¨é…ç½®
sudo ln -s /etc/nginx/sites-available/iquest-coder /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

# 4. æµ‹è¯•è®¿é—®
curl http://ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP/health
```

## ğŸ”Œ é›†æˆåˆ°ä½ çš„é¡¹ç›®

### Python å®¢æˆ·ç«¯ç¤ºä¾‹

```python
from openai import OpenAI

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = OpenAI(
    base_url="http://ä½ çš„æœåŠ¡å™¨IP:8000/v1",
    api_key="dummy"
)

# ç”Ÿæˆä»£ç 
response = client.chat.completions.create(
    model="IQuestLab/IQuest-Coder-V1-14B-Instruct",
    messages=[
        {"role": "user", "content": "å†™ä¸€ä¸ª Python å¿«é€Ÿæ’åºå‡½æ•°"}
    ],
    temperature=0.6,
    top_p=0.85,
    max_tokens=2048
)

print(response.choices[0].message.content)
```

### Node.js é›†æˆï¼ˆä½ çš„é¡¹ç›®ï¼‰

å‚è€ƒ `é›†æˆåˆ°ç°æœ‰é¡¹ç›®.md`ï¼Œæˆ‘å·²ç»ä¸ºä½ å‡†å¤‡äº†ï¼š
- âœ… Express æœåŠ¡æ¨¡å—
- âœ… API è·¯ç”±
- âœ… å‰ç«¯ TypeScript æ¥å£
- âœ… React ç»„ä»¶ç¤ºä¾‹

## ğŸ“ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
docker-compose -f docker-compose-14b.yml ps
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# å®æ—¶æ—¥å¿—
docker-compose -f docker-compose-14b.yml logs -f

# æœ€è¿‘ 100 è¡Œ
docker-compose -f docker-compose-14b.yml logs --tail=100
```

### æŸ¥çœ‹ GPU ä½¿ç”¨
```bash
# å®æ—¶ç›‘æ§
watch -n 1 nvidia-smi

# å•æ¬¡æŸ¥çœ‹
nvidia-smi
```

### é‡å¯æœåŠ¡
```bash
docker-compose -f docker-compose-14b.yml restart
```

### åœæ­¢æœåŠ¡
```bash
docker-compose -f docker-compose-14b.yml down
```

### æŸ¥çœ‹å®¹å™¨èµ„æº
```bash
docker stats iquest-coder-14b
```

## ğŸ› é‡åˆ°é—®é¢˜ï¼Ÿ

### é—®é¢˜ 1: æ¨¡å‹ä¸‹è½½æ…¢
```bash
# å·²é…ç½®å›½å†…é•œåƒï¼ˆhf-mirror.comï¼‰
# å¦‚æœè¿˜æ˜¯æ…¢ï¼Œæ£€æŸ¥ç½‘ç»œè¿æ¥
ping hf-mirror.com
```

### é—®é¢˜ 2: å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose -f docker-compose-14b.yml logs

# æ£€æŸ¥ GPU
nvidia-smi

# é‡æ–°æ„å»º
docker-compose -f docker-compose-14b.yml build --no-cache
```

### é—®é¢˜ 3: ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo lsof -i :8000

# ä¿®æ”¹ç«¯å£ï¼ˆç¼–è¾‘ docker-compose-14b.ymlï¼‰
ports:
  - "8001:8000"
```

### é—®é¢˜ 4: æ¨ç†é€Ÿåº¦æ…¢
```bash
# æ£€æŸ¥ GPU åˆ©ç”¨ç‡
nvidia-smi

# å¦‚æœåˆ©ç”¨ç‡ä½ï¼Œå¢åŠ æ‰¹å¤„ç†å¤§å°
# ç¼–è¾‘ docker-compose-14b.yml
environment:
  - MAX_NUM_BATCHED_TOKENS=16384
  - MAX_NUM_SEQS=512
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ğŸ“– `å¿«é€Ÿéƒ¨ç½²14B.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—
- ğŸ”Œ `é›†æˆåˆ°ç°æœ‰é¡¹ç›®.md` - é¡¹ç›®é›†æˆæ–¹æ¡ˆ
- ğŸ“Š `å‡çº§å»ºè®®.md` - é…ç½®ä¼˜åŒ–å»ºè®®
- ğŸ§ª `test_api_14b.py` - API æµ‹è¯•è„šæœ¬
- ğŸ’» `client_example.py` - å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç 

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] æ‰§è¡Œ `./deploy_14b.sh` æˆåŠŸ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æµ‹è¯•è„šæœ¬è¿è¡ŒæˆåŠŸ
- [ ] GPU æ˜¾å­˜ä½¿ç”¨æ­£å¸¸ï¼ˆçº¦ 10GBï¼‰
- [ ] æ¨ç†é€Ÿåº¦ç¬¦åˆé¢„æœŸï¼ˆ40-60 tokens/sï¼‰
- [ ] å¤–ç½‘å¯ä»¥è®¿é—®ï¼ˆå¦‚æœéœ€è¦ï¼‰

## ğŸ‰ å¼€å§‹ä½¿ç”¨

**ç°åœ¨å°±å¼€å§‹éƒ¨ç½²å§ï¼**

```bash
# 1. ä¸Šä¼ æ–‡ä»¶
scp -r iquest-coder-deploy ubuntu@ä½ çš„æœåŠ¡å™¨IP:~/

# 2. è¿æ¥æœåŠ¡å™¨
ssh ubuntu@ä½ çš„æœåŠ¡å™¨IP

# 3. ä¸€é”®éƒ¨ç½²
cd iquest-coder-deploy
chmod +x deploy_14b.sh
./deploy_14b.sh

# 4. æµ‹è¯•
python3 test_api_14b.py
```

**é¢„è®¡æ—¶é—´**: 10-15 åˆ†é’Ÿï¼ˆåŒ…å«æ¨¡å‹ä¸‹è½½ï¼‰

æœ‰ä»»ä½•é—®é¢˜éšæ—¶é—®æˆ‘ï¼ğŸš€
